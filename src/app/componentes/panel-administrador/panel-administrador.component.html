<br>
<h3 style="text-align: center;">PANEL DE ADMINISTRADCIÓN</h3>
<mat-divider></mat-divider>
<br>
<h4 style="text-align: start;">EDITAR USUARIO</h4>
<table mat-table [dataSource]="dataSource" class="mat-elevation-z8 demo-table">

    <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef>Nombre</th>
        <td mat-cell *matCellDef="let element">{{ element.nombre }}</td>
      </ng-container>

    <ng-container matColumnDef="apellido">
      <th mat-header-cell *matHeaderCellDef>Apellido</th>
      <td mat-cell *matCellDef="let element">{{ element.apellido }}</td>
    </ng-container>
  
    <ng-container matColumnDef="dni">
      <th mat-header-cell *matHeaderCellDef>DNI</th>
      <td mat-cell *matCellDef="let element">{{ element.dni }}</td>
    </ng-container>
  
    <ng-container matColumnDef="edad">
      <th mat-header-cell *matHeaderCellDef>Edad</th>
      <td mat-cell *matCellDef="let element">{{ element.edad }}</td>
    </ng-container>
  
    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef>Email</th>
      <td mat-cell *matCellDef="let element">{{ element.email }}</td>
    </ng-container>
  
    <ng-container matColumnDef="especialidad">
      <th mat-header-cell *matHeaderCellDef>Especialidad</th>
      <td mat-cell *matCellDef="let element">{{ element.especialidad || '(N/A)' }}</td>
    </ng-container>
  
    <ng-container matColumnDef="fecha_registro">
      <th mat-header-cell *matHeaderCellDef>Fecha de Registro</th>
      <td mat-cell *matCellDef="let element">{{ (element.fecha_registro | date) || '(N/A)' }}</td>
    </ng-container>
  
    <ng-container matColumnDef="password">
      <th mat-header-cell *matHeaderCellDef>Password</th>
      <td mat-cell *matCellDef="let element">{{ element.password }}</td>
    </ng-container>
  
    <ng-container matColumnDef="rol">
      <th mat-header-cell *matHeaderCellDef>Rol</th>
      <td mat-cell *matCellDef="let element">{{ element.rol == 1? 'Administrador': element.rol == 2? 'Especialista': element.rol == 3? 'Paciente': '(N/A)' }}</td>
    </ng-container>
  
    <ng-container matColumnDef="rutaArchivoUno">
      <th mat-header-cell *matHeaderCellDef>Ruta de Archivo Uno</th>
      <td mat-cell *matCellDef="let element">{{ element.rutaArchivoUno }}</td>
    </ng-container>
  
    <ng-container matColumnDef="rutaArchivoDos">
      <th mat-header-cell *matHeaderCellDef>Ruta de Archivo Dos</th>
      <td mat-cell *matCellDef="let element">{{ element.rutaArchivoDos || '(N/A)' }}</td>
    </ng-container>
  
    <ng-container matColumnDef="obraSocial">
      <th mat-header-cell *matHeaderCellDef>Obra Social</th>
      <td mat-cell *matCellDef="let element">{{ element.obraSocial || '(N/A)' }}</td>
    </ng-container>
  
    <ng-container matColumnDef="validarEstado">
      <th mat-header-cell *matHeaderCellDef>Validar Estado</th>
      <td mat-cell *matCellDef="let element">{{ element.validarEstado == undefined? '(N/A)':element.validarEstado? 'Si':'No' }}</td>
    </ng-container>
  
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

    <tr mat-row       
        (click)="handleClick(row)"
        *matRowDef="let row; columns: displayedColumns;">
    </tr>
  </table>

<br>

<div class="mat-card">

    <h3 style="text-align: center;">Modo Edición</h3>
    <strong *ngIf="!esEspecialista && selectedUser">Se seleccionó un PACIENTE.</strong>
    <strong *ngIf="esEspecialista && selectedUser">Se seleccionó un ESPECIALISTA.</strong>

    <span *ngIf="!selectedUser">Seleccione una fila para empezar a editar.</span>
    <form *ngIf="selectedUser" (ngSubmit)="submitEditForm()" class="edit-form">

        <div class="form-row">

            <mat-form-field class="form-field">
                <mat-label>Nombre</mat-label>
                <input matInput [(ngModel)]="selectedUser.nombre" name="nombre" required>
            </mat-form-field>

            <mat-form-field class="form-field">
                <mat-label>Apellido</mat-label>
                <input matInput [(ngModel)]="selectedUser.apellido" name="apellido" required>
            </mat-form-field>

            <mat-form-field class="form-field">
                <mat-label>Edad</mat-label>
                <input matInput type="number" [(ngModel)]="selectedUser.edad" name="edad" required>
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field class="form-field">
                <mat-label>DNI</mat-label>
                <input matInput type="text" [(ngModel)]="selectedUser.dni" name="dni" required>
            </mat-form-field>

            <mat-form-field class="form-field">
                <mat-label>Email</mat-label>
                <input matInput type="email" [(ngModel)]="selectedUser.email" name="email" required>
            </mat-form-field>

            <mat-form-field class="form-field">
                <mat-label>Password</mat-label>
                <input matInput [(ngModel)]="selectedUser.password" name="password" required>
            </mat-form-field>
        </div>

        <div class="form-row">
            <mat-form-field class="form-field" *ngIf="esEspecialista && !esAdministrador">
                <mat-label>Especialidad</mat-label>
                <input matInput [(ngModel)]="selectedUser.especialidad" name="especialidad">
            </mat-form-field>

            <mat-form-field class="form-field">
                <mat-label>Rol</mat-label>
                <input matInput [(ngModel)]="selectedUser.rol" name="rol">
            </mat-form-field>

            <mat-form-field class="form-field" *ngIf="!esEspecialista && !esAdministrador">
                <mat-label>Obra Social</mat-label>
                <input matInput [(ngModel)]="selectedUser.obraSocial" name="obraSocial">
            </mat-form-field>
        </div>

        <button mat-raised-button color="primary" type="submit" class="save-button">Guardar Cambios</button>

    </form>
</div>

<mat-divider></mat-divider>
<br>
<h4 style="text-align: start;">VALIDAR ESPECIALISTA</h4>

<div class="container">
    <div class="tabla-especialistas">
      <table mat-table [dataSource]="dataSourceValidar" matSort class="mat-elevation-z8">
        <ng-container *ngFor="let col of displayedColumnsEspecialista" [matColumnDef]="col">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> {{ col | titlecase }} </th>
          <td mat-cell *matCellDef="let element"> {{ element[col] }} </td>
        </ng-container>
  
        <tr mat-header-row *matHeaderRowDef="displayedColumnsEspecialista"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsEspecialista;"
            (click)="seleccionarEspecialista(row)"
            [class.mat-row-selected]="selection.isSelected(row)">
        </tr>
      </table>
    </div>
  
    <div  class="detalle-especialista">
      <span *ngIf="!especialistaSeleccionado">Seleccione una fila para empezar.</span>
      <div *ngIf="especialistaSeleccionado" class="cuadro-detalle">
        <h3>Detalles del Especialista</h3>
        <p><strong>Nombre:</strong> {{ especialistaSeleccionado?.nombre }}</p>
        <p><strong>Apellido:</strong> {{ especialistaSeleccionado?.apellido }}</p>
        <p><strong>DNI :</strong> {{ especialistaSeleccionado?.dni }}</p>
        <p><strong>Email:</strong> {{ especialistaSeleccionado?.email }}</p>
        <p><strong>Especialidad:</strong> {{ especialistaSeleccionado?.especialidad }}</p>
        <p><strong>Rol:</strong> {{ especialistaSeleccionado.rol == 1? 'Administrador': especialistaSeleccionado.rol == 2? 'Especialista': especialistaSeleccionado.rol == 3? 'Paciente': '(N/A)' }}</p>

        <button mat-raised-button color="primary" (click)="habilitarEspecialista(selectedUser)">Habilitar Especialista</button>
      </div>
    </div>
  </div>

  <mat-divider></mat-divider>
<br>
<h4 style="text-align: start;">REGISTRAR NUEVO USUARIO</h4>

<mat-tab-group [backgroundColor]="'primary'" animationDuration="0ms">
    <mat-tab label="Registrar Paciente">
        <app-registro-paciente></app-registro-paciente>
    </mat-tab>

    <mat-tab label="Registrar Especialista">
       <app-registro-especialista></app-registro-especialista>
    </mat-tab>

    <mat-tab label="Registrar Administrador">
        <app-registro-administrador></app-registro-administrador>
    </mat-tab>
</mat-tab-group>